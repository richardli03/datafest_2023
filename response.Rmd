---
title: "Datafest"
author: "Drew, Richard, Anmol, Meredith, An"
date: 2023-4-7
output:
  github_document:
    toc: true
---

# Question

What is the average time of response for a question plot? 

# Setup

<!-- ----------------------------------------------------------------------- -->

```{r setup}
library(tidyverse)
```

# Initial Glimpse
```{r}

# questions %>%
#   glimpse()

question_filtered <- questions %>%
  filter(
    str_detect(TakenOnUtc, "^2"),
    str_detect(AskedOnUtc, "^2")
  )

question_filtered$TakenOnUtc <- as.POSIXct(question_filtered$TakenOnUtc, format = "%Y-%m-%d %H:%M:%S")
question_filtered$AskedOnUtc <- as.POSIXct(question_filtered$AskedOnUtc, format = "%Y-%m-%d %H:%M:%S")

# Replace missing values with a default datetime object
question_filtered$TakenOnUtc[is.na(question_filtered$TakenOnUtc)] <- as.POSIXct("1970-01-01 00:00:00", tz = "UTC", format = "%Y-%m-%d %H:%M:%S")
question_filtered$AskedOnUtc[is.na(question_filtered$AskedOnUtc)] <- as.POSIXct("1970-01-01 00:00:00",  tz = "UTC", format = "%Y-%m-%d %H:%M:%S")

# CLEAR VALUES THAT AREN'T FROM 2000s
# question_filtered

solved <- question_filtered %>%
  mutate(
    time_to_take = difftime(TakenOnUtc,AskedOnUtc)
  ) %>%
  arrange(desc(time_to_take))

solved

solved %>%
  summarize(
    State = StateAbbr,
    Asked_Time = AskedOnUtc,
    Taken_Time = TakenOnUtc,
    diff = as.integer(time_to_take)
  ) %>%
  ggplot() + 
  geom_boxplot(aes(x = State, y = diff)) + 
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) + 
  scale_y_log10()
  

  



```